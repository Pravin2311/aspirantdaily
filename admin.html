<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard ‚Äì AspirantDaily</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./styles.css">
</head>

<body>

  <div class="admin-container">
    <h1>Admin Dashboard</h1>
    <p class="admin-hint">
      Internal use only ‚Ä¢ Admin actions are irreversible
    </p>

    <!-- ===============================
         REGENERATE SUBJECT
         =============================== -->
    <div class="admin-section">
      <h2>Regenerate Subject Pool</h2>

      <select id="subjectSelect">
        <option value="reasoning">Reasoning</option>
        <option value="quant">Quantitative Aptitude</option>
        <option value="computer">Computer Awareness</option>
        <option value="science">General Science</option>
        <option value="static-gk">Static GK</option>
        <option value="current-affairs">Current Affairs</option>
        <option value="english">English (Grammar + Verbal)</option>
        <option value="economics">Economics</option>
        <option value="geography">Geography</option>

      </select>

      <button class="admin-btn primary" onclick="regenerate()">
        Regenerate Subject
      </button>
    </div>

    <!-- ===============================
         MONTHLY CA ARCHIVE
         =============================== -->
    <div class="admin-section">
      <h2>Monthly Current Affairs Archive</h2>

      <button class="admin-btn warning" onclick="archiveCA()">
        Archive Current Month
      </button>
    </div>

    <!-- STATUS -->
    <div id="status" class="admin-status">
      Ready
    </div>

    <div class="admin-hint">
      Tip: Regenerating non-daily subjects should be done rarely
    </div>
  </div>

  <!-- ===============================
       ADMIN LOGIC
       =============================== -->
  <script>
    const API = "https://exam-prep-generator.mydomain2311.workers.dev";
    const TOKEN = prompt("Enter admin token:");

    async function regenerate() {
      const subject = document.getElementById("subjectSelect").value;
      setStatus("Regenerating " + subject + "‚Ä¶");

      try {
        const res = await fetch(
          `${API}/?admin=1&action=regenerate&subject=${subject}&token=${TOKEN}`
        );
        const data = await res.json();

        setStatus(
          data.success
            ? `‚úÖ ${subject} regenerated successfully`
            : `‚ùå ${JSON.stringify(data)}`
        );
      } catch (e) {
        setStatus("‚ùå Network error");
      }
    }

    async function archiveCA() {
      setStatus("Archiving current affairs‚Ä¶");

      try {
        const res = await fetch(
          `${API}/?admin=1&action=archive-ca&token=${TOKEN}`
        );
        const data = await res.json();

        setStatus(
          data.success
            ? `üì¶ Current Affairs archived for ${data.archived}`
            : `‚ùå ${JSON.stringify(data)}`
        );
      } catch (e) {
        setStatus("‚ùå Network error");
      }
    }

    function setStatus(msg) {
      document.getElementById("status").innerText = msg;
    }
  </script>

</body>
</html>
